import numpy as np

def create_sequences(df, input_window=24, forecast_horizon=1):
    """
    Create sequences where each input is a window of `input_window` consecutive hours and
    each target is the weather features for the next `forecast_horizon` hours.
    
    Returns:
        X: NumPy array of shape (num_samples, input_window, num_features)
        y: NumPy array of shape (num_samples, forecast_horizon, num_features)
    """
    features = ["temperature", "humidity", "wind_speed", "wind_deg"]
    data = df[features].values
    X, y = [], []
    total_length = len(data)
    for i in range(total_length - input_window - forecast_horizon + 1):
        X.append(data[i : i + input_window])
        y.append(data[i + input_window : i + input_window + forecast_horizon])
    return np.array(X), np.array(y)

X, y = create_sequences(df, input_window=24, forecast_horizon=1)
print("Input shape:", X.shape)  # (num_samples, 24, num_features)
print("Target shape:", y.shape)  # (num_samples, 1, num_features)
